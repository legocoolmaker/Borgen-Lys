<!DOCTYPE html>
<head>
  
  <link rel="stylesheet" href="style.css">
  <style>
    .page-container {
      width: 100%;
      height: auto;
     
    }
    .image-container {
      position: relative;
      width: 80%;
      height: auto;
      margin:auto;

    }
    .image {
      width: 100%;
      display: block;
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5); /* darken everything */
      pointer-events: none; /* allow mouse to reach imageContainer */
      clip-path: none;
      transition: clip-path 0.2s ease;
    }
    
  </style>
</head>
<body>
  <div class="top-bar-container">
    <a href="index.html" class="top-bar-links">Hjem</a>
    <a href="begynnerguide.html" class="top-bar-links">Begynnerguide</a>
    <a href="oversikt.html" class="top-bar-links">Oversikt av Lysmikseren</a>
    <a href="scener.html" class="top-bar-links">Memory</a>
    <a href="chase.html" class="top-bar-links">Chase</a>
    <a href="dmx.html" class="top-bar-links">DMX mapping</a>
    <a href="stl.html" class="top-bar-links">Sound to Light</a>
    <a href="annet.html" class="top-bar-links">Annet</a>
  </div>
  <div class="image-container" id="imageContainer"> 
    <img class="image" src="image.png" id="image">
    <div class="overlay" id="overlay"></div>
  </div>
  <div class="textContainer" id="textContainer">
    <h2 class="caption" id="caption"> </h2>
    <p class="normal-text" id="caption-text"></p>
  </div>

   
  <script>
    //HTML objects
    const imageContainer = document.getElementById("imageContainer");
    const overlay = document.getElementById("overlay");
    const caption = document.getElementById("caption")
    const captionText = document.getElementById("caption-text")
    // [[StartX,EndX],[StartY,EndY]] (Normal numbers)
    const rectArray = [
      [[0.1110,0.1870],[0.0375,0.0929]], // Av/på
      [[0.5785,0.6235],[0.3027,0.5732]], // Memory bank
      [[0.5780,0.7915],[0.1286,0.2071]], // Avansert
      [[0.5785,0.6235],[0.5857,0.7518]], // Sound to light knapper
      [[0.5785,0.6235],[0.7652,0.9366]], // Special knapper
      [[0.8120,0.9415],[0.1277,0.2062]], // Knapper oppe i høyre hjørne
      [[0.6290,0.7160],[0.8420,0.9366]], // Flash preset & memory
      [[0.7210,0.8080],[0.8420,0.9366]], // Main knapper
      [[0.8130,0.9425],[0.8420,0.9366]], // Mode knapper
      [[0.6285,0.7590],[0.4688,0.8313]], // Main sliders
      [[0.7625,0.8515],[0.4679,0.8313]], // Chase slider
      [[0.8545,0.9420],[0.4679,0.8313]], // X-fade & speed
      [[0.6270,0.9480],[0.2134,0.4598]], // Interface
      [[0.3640,0.4010],[0.0277,0.0982]], // Lamp
      [[0.7745,0.8950],[0.0455,0.1071]], // PCMCIA card
      [[0.4300,0.7560],[0.0000,0.0205]], // Ports
      [[0.4050,0.5715],[0.8607,0.9179]], // Sound to light / Chase to memory flash knapper
      [[0.0540,0.5740],[0.8429,0.9384]], // Flash knapper
      [[0.4050,0.5710],[0.4679,0.8268]], // Sound to light / Chase to memory sliders
      [[0.0535,0.6235],[0.0875,0.4571]], // Preset sliders
      [[0.0535,0.5735],[0.4643,0.8330]]  // Memory sliders
    ];
    const captionData = [
  {
    "Caption":"Av/på",
    "Text":"Skrur lysmiksern av og på. Husk å trykke på Blackout før du skrur av så ingen signaler sendes når man skrur av (? ikke sikker på om det har noe å si)"
  },
  {
    "Caption":"Memory bank",
    "Text":"Her har man 2 knapper og et display. Nummeret på displayet viser hvilket set med lagrede scener som brukes av memorysliderne. 'UP' for å ender bank med +1 og 'DOWN' for å endre med -1. Man har valgene 0-9 og P som står for preset. Når P er på vil memorysliderne virke som presetsliderne"
  },
  {
    "Caption":"Avansert",
    "Text":"Her er knapper tilknytted <a href='scener.html'>Memory</a>, <a href='chase.html'>Chase</a>  "
  },
  {
    "Caption":"Sound to light knapper",
    "Text":""
  },
  {
    "Caption":"Special knapper",
    "Text":""
  },
  {
    "Caption":"Knapper oppe i høyre hjørne",
    "Text":""
  },
  {
    "Caption":"Flash preset & memory",
    "Text":""
  },
  {
    "Caption":"Main knapper",
    "Text":""
  },
  {
    "Caption":"Mode knapper",
    "Text":""
  },
  {
    "Caption":"Main sliders",
    "Text":""
  },
  {
    "Caption":"Chase slider",
    "Text":""
  },
  {
    "Caption":"X-fade & speed",
    "Text":""
  },
  {
    "Caption":"Interface",
    "Text":""
  },
  {
    "Caption":"Lamp",
    "Text":""
  },
  {
    "Caption":"PCMCIA card",
    "Text":""
  },
  {
    "Caption":"Ports",
    "Text":""
  },
  {
    "Caption":"Sound to light / Chase to memory flash knapper",
    "Text":""
  },
  {
    "Caption":"Flash knapper",
    "Text":""
  },
  {
    "Caption":"Sound to light / Chase to memory sliders",
    "Text":""
  },
  {
    "Caption":"Preset sliders",
    "Text":""
  },
  {
    "Caption":"Memory sliders",
    "Text":""
  }
]
    //Variables
    let isClicked = false;


    
    function addOverlay(e){
      
      const rect = imageContainer.getBoundingClientRect();
      const x = e.clientX -rect.left;
      const y = e.clientY - rect.top;
      let hovered = false;
      overlay.style.backgroundColor = 'rgba(0,0,0,0.5)';

      for (const [index,element] of rectArray.entries()) {
        const [[xStart,xEnd],[yStart,yEnd]] = element;
        const absX1 = rect.width * xStart;
        const absX2 = rect.width * xEnd;
        const absY1 = rect.height * yStart;
        const absY2 = rect.height * yEnd;

        if (absX1<x && x<absX2 && absY1<y && y<absY2) {
          overlay.style.clipPath = `polygon(
            0% 0%,
            0% 100%,
            ${xStart * 100}% 100%,
            ${xStart * 100}% ${yStart* 100}%,
            ${xEnd * 100}% ${yStart * 100}%,
            ${xEnd * 100}% ${yEnd * 100}%,
            ${xStart * 100}% ${yEnd * 100}%,
            ${xStart * 100}% 100%,
            100% 100%,
            100% 0%
          )`;
          
          caption.innerHTML = `${captionData[index]["Caption"]}`
          captionText.innerHTML = `${captionData[index]["Text"]}`

          hovered = true;
          break;
        }

      }
      if (!hovered) {
        overlay.style.clipPath = 'none';
      }
    }
    function addLeaveEffect(e){
      overlay.style.clipPath = 'none';
      overlay.style.backgroundColor = 'rgba(0,0,0,0)';
      caption.innerHTML = " d";
      captionText.innerHTML = "";
    }
    //Add the listeners in the start
    imageContainer.addEventListener('mousemove',addOverlay)
    imageContainer.addEventListener('mouseleave',addLeaveEffect)
    
    
    
    
    addEventListener('click',(e)=> {
      console.log(isClicked)
      if (isClicked){
        imageContainer.addEventListener('mousemove',addOverlay)
        imageContainer.addEventListener('mouseleave',addLeaveEffect)
      } else {
        imageContainer.removeEventListener('mousemove', addOverlay)
        imageContainer.removeEventListener('mouseleave',addLeaveEffect)
      }
      isClicked = !isClicked;
    });
  </script>
</body> 